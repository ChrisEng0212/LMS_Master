{% extends "layout.html" %}

{% block content %}

<span id="projectDict" style="display:none">{{nmeString}}</span>

<div id="vue-app">

<div class="content-section">
        <h1> Movie Projects </h1>
</div>

<div class="content-section">
  <div class="sticky">
   <audio controls id="handler"> </audio>
  </div>

    <div style="overflow-x:auto;">
      <table class="table table-sm">
        <thead>
            <tr>
              <th scope="col" style="width:5%"  >Movie</th>
              <th scope="col" style="width:10%" >Names</th>
              <th scope="col" >0</th>
              <th scope="col" >1</th>
              <th scope="col" >2</th>
              <th scope="col" >3</th>
              <th scope="col" style="width:7%" >4</th>
            </tr>
        </thead>

        <tbody>
        <template v-for="(movie, key) in projectOBJ" :key="key">
          <button class="btn btn-warning" @click="show = key"> [[key]] </button>

          <template  v-for="(proj, team) in movie" :key="team">
          <tr v-if="show == key">
              <td>
              [[team]]
              </td>
              <td>
              [[proj.names]]
              </td>
              <td>
              [[proj.q01]] <br>
              [[proj.q02]]
              </td>
              <td>
              [[proj.q11]] <br>
              [[proj.q12]]
              </td>
              <td>
              [[proj.q21]] <br>
              [[proj.q22]] <br>
              [[proj.q23]]
              </td>
              <td>
              [[proj.q31]] <br>
              [[proj.q32]] <br>
              [[proj.q33]]
              </td>
              <td>
              <button v-if="proj.audio" class="btn btn-info" @click="playAudio(proj.audio)"> Play </button>
              </td>

          </tr>

        </template>
        </template>

        </tbody>

      </table>
    </div>

</div>


</div> <!-- end of Vue app -->


{% endblock %}

{% block script %}

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script>

<script type="text/javascript" >

var projectDict = document.getElementById('projectDict').innerHTML
var OBJ = JSON.parse(projectDict)
console.log('projecDict', OBJ);


startVue(OBJ)

function startVue(OBJ){ new Vue({

    el: '#vue-app',
    delimiters: ['[[', ']]'],
    data: {
        projectOBJ: OBJ,
        show: null
    },
    methods: {
        goTo: function(key) {

          // go to HTTPS version
          var str = window.location.href

          let url = (str).split('_dash')[0] + '_check/' + key
          console.log('goTO', url);
            window.location = url
            console.log('DONE');
        },
        playAudio: function (arg) {
          console.log(arg)
          let audio = document.getElementById('handler')
          audio.src = arg
          audio.play()
        },

    }
})// end NEW VUE



}// endFunction

</script>

{% endblock %}

